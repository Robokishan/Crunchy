pipeline {
    agent any
    environment {     
      DOCKERHUB_CREDENTIALS= credentials('dockerhubcredentials')     
    } 
    stages {
        stage('Building') {
            steps {
                dir('CrunchyCrawler') {
                  sh "docker build -t robokishan/crunchy:crawler -f Dockerfile ."
                }
            }
        }
        stage('push') {
            steps {
                sh 'echo $DOCKERHUB_CREDENTIALS_PSW | docker login -u $DOCKERHUB_CREDENTIALS_USR --password-stdin'                 
                echo 'Login Completed'                
                sh "docker image push robokishan/crunchy:crawler"
            }
        }
    }
    post{
      always {
        sh 'docker logout'
      }      
    } 
}